#:kivy 2.1.0

<ScreenOperateAuto>:
    MDBoxLayout:
        orientation: "vertical"

		# header layout
        MDBoxLayout:
            id: header_layout
            orientation: "horizontal"
            padding: 20
			size_hint_y: 0.1
                    
            Image:
                id: logo
                source:'asset/logo_rafindo.png'
                size_hint_x: 0.25
                allow_stretch: True 

			MDBoxLayout:
				orientation: "vertical"

				MDLabel:
					id: subtitle            
					text: "PIPE BENDING CNC MACHINE"
					halign: "center"
					valign: "middle"
					font_style: 'H5'

				MDLabel:
					id: comm_status
					text: "Status:"
					halign: "center"
					valign: "middle"
                  
            Image:
                id: logo
                source:'asset/logo_polman.png'
                size_hint_x: 0.25
                allow_stretch: True  

		# title layout
		MDBoxLayout:
			id: layout_title
			orientation: "horizontal"
			size_hint_y: 0.05

			MDIconButton:
				id: bt_menu
				icon: "menu"
				size_hint_x: 0.2
				on_press: root.screen_main_menu()

			MDLabel:
				text: "OPERATE AUTO"
				halign: "center"
				valign: "middle"
				font_style: 'H6'

			MDIconButton:
				id: bt_shutdown
				icon: "power"
				size_hint_x: 0.2
				on_press: root.exec_shutdown()

		# auto operate layout
		MDBoxLayout:
			id: layout_operate_auto
			orientation: "vertical"
			size_hint_y: 0.80
			padding:20
			spacing:20

			# illustration pipe
			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.5
				padding: 40

				MDBoxLayout:
					id: pipe_bended_illustration
					size_hint_x: 0.8
					
				MDGridLayout:
					cols:1
					spacing:20
					size_hint_x: 0.2

					MDFillRoundFlatIconButton:
						text: "TOP"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(90, -90, 0)

					MDFillRoundFlatIconButton:
						text: "FRONT"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(0, 0, 0)

					MDFillRoundFlatIconButton:
						text: "SIDE"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph(0, -90, 0)

					MDFillRoundFlatIconButton:
						text: "ISOMETIC"
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_graph()

					MDFillRoundFlatIconButton:
						icon: "arrow-up-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(0)

					MDFillRoundFlatIconButton:
						icon: "arrow-down-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(1)

					MDFillRoundFlatIconButton:
						icon: "arrow-left-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(2)

					MDFillRoundFlatIconButton:
						icon: "arrow-right-bold"
						text: " "
						font_style: 'Button'
						size_hint_x: 0.5
						on_press: root.update_view(3)

			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.05
				spacing:20

				MDIconButton:
					id: lp_run
					text: " "
					font_style: 'Button'
					size_hint_x: 0.5

				MDIconButton:
					id: lp_alarm
					text: " "
					font_style: 'Button'
					size_hint_x: 0.5

			MDFillRoundFlatButton:
				id: bt_mode
				text: "MODE MANUAL"
				font_style: 'Button'
				size_hint_x: 1
				size_hint_y: 0.03
				on_press: root.exec_mode()

			MDBoxLayout:
				orientation: "horizontal"
				size_hint_y: 0.05
				spacing:20

				MDFillRoundFlatIconButton:
					id: bt_start
					text: "START"
					font_style: 'Button'
					size_hint_x: 0.25
					on_press: root.exec_start()
					on_release: root.end_start()

				MDFillRoundFlatIconButton:
					id: bt_stop
					text: "STOP"
					font_style: 'Button'
					size_hint_x: 0.25
					on_press: root.exec_stop()
					on_release: root.end_stop()

				MDFillRoundFlatIconButton:
					id: bt_origin
					text: "ORIGIN"
					font_style: 'Button'
					size_hint_x: 0.25
					on_press: root.exec_origin()
					on_release: root.end_origin()

				MDFillRoundFlatIconButton:
					id: bt_reset
					text: "RESET"
					font_style: 'Button'
					size_hint_x: 0.25
					on_press: root.exec_reset()
					on_release: root.end_reset()

			MDGridLayout:
				cols:7
				spacing: 20, 0
				padding: 20
				size_hint_y: 0.07

				MDLabel:
					text: "Feeding Setpoint"
					font_style: 'Body2'
					size_hint_x: 0.2

				MDLabel:
					text: "Feeding Speed Mode"
					font_style: 'Body2'
					size_hint_x: 0.1

				MDLabel:
					text: "Bending Setpoint"
					font_style: 'Body2'
					size_hint_x: 0.2

				MDLabel:
					text: "Bending Speed Mode"
					font_style: 'Body2'
					size_hint_x: 0.1

				MDLabel:
					text: "Turning Setpoint"
					font_style: 'Body2'
					size_hint_x: 0.2

				MDLabel:
					text: "Turning Speed Mode"
					font_style: 'Body2'
					size_hint_x: 0.1

				MDLabel:
					text: "Bed Position"
					font_style: 'Body2'
					size_hint_x: 0.1

				MDLabel:
					id: lb_set_feed
					text: "000.00"
					font_style: 'H4'
					size_hint_x: 0.2

				MDFillRoundFlatIconButton:
					id: lb_feed_speed
					icon: "speedometer"
					text: "1"
					size_hint_x: 0.1

				MDLabel:
					id: lb_set_bend
					text: "000.00"
					font_style: 'H4'
					size_hint_x: 0.2

				MDFillRoundFlatIconButton:
					id: lb_bend_speed
					icon: "speedometer"
					text: "1"
					size_hint_x: 0.1

				MDLabel:
					id: lb_set_turn
					text: "000.00"
					font_style: 'H4'
					size_hint_x: 0.2

				MDFillRoundFlatIconButton:
					id: lb_turn_speed
					icon: "speedometer"
					text: "1"
					size_hint_x: 0.1

				MDFillRoundFlatIconButton:
					id: lb_bed_pos
					icon: "arrow-expand-vertical"
					text: "DN"
					size_hint_x: 0.1

			MDGridLayout:
				cols:3
				spacing: 20, 0
				padding: 20
				size_hint_y: 0.20

				MDLabel:
					text: "Feeding Realtime Data"
					font_style: 'Body1'

				MDLabel:
					text: "Bending Realtime Data"
					font_style: 'Body1'

				MDLabel:
					text: "Turning Realtime Data"
					font_style: 'Body1'

				MDLabel:
					id: lb_real_feed
					text: "000.00"
					font_style: 'H1'

				MDLabel:
					id: lb_real_bend
					text: "000.00"
					font_style: 'H1'

				MDLabel:
					id: lb_real_turn
					text: "000.00"
					font_style: 'H1'
					
			MDBoxLayout:
				orientation: "horizontal"
				spacing: 20
				padding: 0, 20
				size_hint_y: 0.1

				MDFillRoundFlatIconButton:
					icon: "reload"
					text: "RELOAD DATA"
					font_style: 'Button'
					size_hint_x: 0.5
					on_release: root.reload()

				MDFillRoundFlatIconButton:
					icon: "folder"
					text: "OPEN FILE"
					font_style: 'Button'
					size_hint_x: 0.5
					on_release: root.file_manager_open()			

		# MDRectangleFlatIconButton: navigation operation
		MDBoxLayout:
			orientation: "horizontal"
			size_hint_y: 0.05
			padding:20
			spacing:20

			MDFillRoundFlatIconButton:
				id: bt_screen_manual
				icon: "controller-classic"
				text: "MANUAL OPERATION"
				font_style: 'H6'
				size_hint_x: 0.5
				on_press: root.screen_operate_manual()
			
			MDFillRoundFlatIconButton:
				id: bt_screen_auto
				icon: "console"
				text: "AUTOMATIC OPERATION"
				font_style: 'H6'
				size_hint_x: 0.5
				on_press: root.screen_operate_auto()	
